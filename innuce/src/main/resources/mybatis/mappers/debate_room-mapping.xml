<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.mc.innuce.domain.debate.dao.DebateRoomDAO">
	<select id="openDebateRoomList" resultType="debateroomdto">
		select *
		from debate_room
		where debate_room_status in (1, 2)
	</select>
	
	<select id="selectOneDebateRoom" parameterType="int" resultType="debateroomdto">
		select *
		from debate_room
		where debate_room_key = #{debate_room_key}
	</select>
	
	<update id="increaseParticipants" parameterType="int">
		update debate_room
		set participants_num = participants_num + 1
		where debate_room_key = #{debate_room_key}
	</update>
	
	<update id="decreaseParticipants" parameterType="int">
		update debate_room
		set participants_num = participants_num - 1
		where debate_room_key = #{debate_room_key}
	</update>
	
	<select id="selectExistKeywordList" resultType="int">
		select keyword_key
		from debate_room
	</select>
	
	<insert id="createDebateRoom" parameterType="java.util.List">
		insert into
		debate_room(keyword_key, participants_num, debate_room_regdate, debate_room_name, debate_room_status)
		values
		<foreach collection="newKeywordList" item="keyword_key" separator=" , ">
			(#{keyword_key}, 0, now(), (select keyword_content from keyword where keyword_key = #{keyword_key}), 2)
		</foreach>
	</insert>
</mapper>